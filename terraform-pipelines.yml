trigger: 
  - releases/*
  - main

variables:
  - group: terraform-environments

pool:
  vmImage: ubuntu-latest

stages:
- stage: terraform_validate
  displayName: Install terraform and validate code
  jobs: 
   - job: 
     continueOnError: false
     steps:
       - task: TerraformInstaller@0
         displayName: Install Terraform
         inputs:
           terraformVersion: latest
       - task: TerraformTaskV4@4
         displayName: 'Terraform Init'
         inputs:
           provider: 'azurerm'
           command: 'init'
           backendServiceArm: 'none'
           backendAzureRmResourceGroupName: 'none'
           backendAzureRmStorageAccountName: 'none'
           backendAzureRmContainerName: 'none'
           backendAzureRmKey: 'none'
       - task: TerraformTaskV4@4
         displayName: 'Terraform Validate'
         inputs:
          provider: 'azurerm'
          command: 'validate'